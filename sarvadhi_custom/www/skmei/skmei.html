<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ _("Support Request") }}</title>
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="./skmei.css">
</head>
<body>

<!-- Support Form Container -->
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-md-10">
            <div class="card shadow">
                <div class="card-body p-4">
                    <a class="row justify-content-center" href="https://skmei.in">
                        <img src="./logo.svg" alt="SKMEI Logo" height="40">
                    </a>
                    <form id="support-form" enctype="multipart/form-data">
                        <!-- Personal Information Section -->
                        <div class="section-title">
                            <h4>{{ _("Personal Information") }}</h4>
                        </div>
                        <div class="row">
                            <!-- Full Name -->
                            <div class="col-md-6 form-group">
                                <label for="customer_name">{{ _("Full Name") }} <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="customer_name" name="customer_name" required>
                                <div class="invalid-feedback">{{ _("Please enter your full name") }}</div>
                            </div>
                            <!-- Email -->
                            <div class="col-md-6 form-group">
                                <label for="email">{{ _("Email Address") }} <span class="text-danger">*</span></label>
                                <input type="email" class="form-control" id="email" name="email" required>
                                <div class="invalid-feedback">{{ _("Please enter a valid email address") }}</div>
                            </div>
                        </div>

                        <div class="row">
                            <!-- Mobile Number -->
                            <div class="col-md-6 form-group">
                                <label for="mobile_number">{{ _("Mobile Number") }} <span class="text-danger">*</span></label>
                                <input type="tel" class="form-control" id="mobile_number" name="mobile_number" required>
                                <div class="invalid-feedback">{{ _("Please enter a valid 10-digit mobile number starting with 6, 7, 8, or 9") }}</div>
                            </div>

                            <!-- Address -->
                            <div class="col-md-6 form-group">
                                <label for="address">{{ _("Address") }}</label>
                                <input type="text" class="form-control" id="address" name="address">
                            </div>
                        </div>

                        <!-- Product Information Section -->
                        <div class="section-title mt-4">
                            <h4>{{ _("Product Information") }}</h4>
                        </div>

                        <div class="row">
                            <!-- Product Model -->
                            <div class="col-md-6 form-group">
                                <label for="product_model">{{ _("Product Model") }} <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="product_model" name="product_model" required>
                                <div class="invalid-feedback">{{ _("Please enter the product model") }}</div>
                            </div>

                            <!-- Purchase Date -->
                            <div class="col-md-6 form-group">
                                <label for="purchase_date">{{ _("Purchase Date") }}</label>
                                <input type="date" class="form-control" id="purchase_date" name="purchase_date">
                            </div>
                        </div>

                        <!-- Issue Details Section -->
                        <div class="section-title mt-4">
                            <h4>{{ _("Issue Details") }}</h4>
                        </div>

                        <div class="row">
                            <!-- Issue Type -->
                            <div class="col-md-6 form-group">
                                <label for="issue_type">{{ _("Issue Type") }} <span class="text-danger"></span></label>
                                <select class="form-control" id="issue_type" name="issue_type" required>
                                    <option value="" disabled selected>Select Issue Type</option>
                                </select>
                                <div class="invalid-feedback">{{ _("Please select an issue type") }}</div>
                            </div>

                            <!-- Issue Priority -->
                            <div class="col-md-6 form-group">
                                <label for="priority">{{ _("Priority") }}</label>
                                <select class="form-control" id="priority" name="priority">
                                    <option value="Low">{{ _("Low") }}</option>
                                    <option value="Medium" selected>{{ _("Medium") }}</option>
                                    <option value="High">{{ _("High") }}</option>
                                    <option value="Urgent">{{ _("Urgent") }}</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="issue_description">{{ _("Issue Description") }} <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="issue_description" name="issue_description" rows="4" required></textarea>
                            <div class="invalid-feedback">{{ _("Please describe the issue in detail") }}</div>
                        </div>

                        <!-- Attachments Section -->
                        <div class="section-title mt-4">
                            <h4>{{ _("Attachments") }}</h4>
                        </div>

                        <div class="row">
                            <!-- Product Images -->
                            <div class="col-md-6 form-group">
                                <label for="product_images">{{ _("Product Images") }}</label>
                                <input type="file" class="form-control-file" id="product_images" name="product_images" multiple accept="image/*">
                                <small class="form-text text-muted">{{ _("Upload up to 3 images of your product (JPEG, PNG, or WebP)") }}</small>
                                <div class="image-preview-container mt-2" id="image-preview-container"></div>
                            </div>

                            <!-- Receipt Upload -->
                            <div class="col-md-6 form-group">
                                <label for="receipt">{{ _("Purchase Receipt") }}</label>
                                <input type="file" class="form-control-file" id="receipt" name="receipt" accept="image/*,.pdf">
                                <small class="form-text text-muted">{{ _("Upload your purchase receipt (JPEG, PNG, or PDF)") }}</small>
                                <div class="receipt-preview-container mt-2" id="receipt-preview-container"></div>
                            </div>
                        </div>

                        <!-- Video Upload (if applicable) -->
                        <div class="form-group">
                            <label for="video">{{ _("Video of the Issue (if applicable)") }}</label>
                            <input type="file" class="form-control-file" id="video" name="video" accept="video/mp4,video/webm">
                            <small class="form-text text-muted">{{ _("Upload a short video showing the issue (MP4 or WebM, max 100MB)") }}</small>
                            <div class="video-preview-container mt-2" id="video-preview-container"></div>
                        </div>

                        <!-- Additional Notes -->
                        <div class="form-group">
                            <label for="additional_notes">{{ _("Additional Notes") }}</label>
                            <textarea class="form-control" id="additional_notes" name="additional_notes" rows="3"></textarea>
                        </div>

                        <!-- Terms and Conditions -->
                        <div class="form-group">
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="terms_agreed" name="terms_agreed" required>
                                <label class="custom-control-label" for="terms_agreed">
                                    {{ _("I agree to the") }} <a href="/terms" target="_blank">{{ _("Terms and Conditions") }}</a>
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="invalid-feedback">{{ _("You must agree to the terms and conditions") }}</div>
                            </div>
                        </div>

                        <!-- reCAPTCHA v3 token field
                        <input type="hidden" name="g-recaptcha-response" id="g-recaptcha-response">
                        
                         reCAPTCHA badge - placed inside the form before submit button -->
                        <!-- <div class="recaptcha-container text-center my-4">
                            <small class="text-muted">
                                {{ _("This site is protected by reCAPTCHA and the Google") }}
                              <a href="https://policies.google.com/privacy" target="_blank">{{ _("Privacy Policy") }}</a> {{ _("and") }}
                                <a href="https://policies.google.com/terms" target="_blank">{{ _("Terms of Service") }}</a> {{ _("apply.") }} 
                            </small>
                        </div>
                        
                  
                   Submit Button -->
                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg px-5">{{ _("Submit Request") }}</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>





   


<!-- Modal for displaying messages -->
<div class="modal fade" id="responseModal" tabindex="-1" role="dialog" aria-labelledby="responseModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="responseModalLabel">{{ _("Support Request") }}</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" id="modal-message">
                <!-- Message will be inserted here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">{{ _("Close") }}</button>
            </div>
        </div>
    </div>
</div>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <p>&copy; {{ frappe.utils.nowdate().split('-')[0] }} SKMEI. {{ _("All rights reserved.") }}</p>
            </div>
            <div class="col-md-6 text-md-right">
                <ul class="footer-links list-inline mb-0 d-inline-block">
                    <li class="list-inline-item"><a href="/privacy-policy">{{ _("Privacy Policy") }}</a></li>
                    <li class="list-inline-item"><a href="/terms">{{ _("Terms of Service") }}</a></li>
                    <li class="list-inline-item"><a href="/contact">{{ _("Contact Us") }}</a></li>
                </ul>
                <!-- reCAPTCHA Container -->
                <div id="recaptcha-container" class="d-inline-block ml-3 align-middle recaptcha-box">
                    <p>reCAPTCHA</p>
                </div>
            </div>
        </div>
    </div>
</footer>


    <!-- jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"></script>
    
    <!-- Custom JS -->
    <script src="./skmei.js"></script>
</body>

<script>
    document.addEventListener("DOMContentLoaded", function () {
    // Fetch issue types from the backend
    fetch('/api/method/sarvadhi_custom.api.support.get_issue_types')
        .then(response => response.json()) // Parse the JSON response
        .then(data => {
            console.log("Fetched Issue Types:", data);

            // Get the dropdown element
            const issueTypeDropdown = document.getElementById("issue_type");

            // Clear existing options (except the default one)
            issueTypeDropdown.innerHTML = '<option value="" disabled selected>Select Issue Type</option>';

            // Populate the dropdown with fetched issue types
            if (data && data.message) {
                data.message.forEach(issueType => {
                    const option = document.createElement("option");
                    option.value = issueType.name; // Use the 'name' field as the value
                    option.textContent = issueType.name; // Display the 'name' field
                    issueTypeDropdown.appendChild(option);
                });
            } else {
                console.error("No issue types found or invalid response:", data);
            }
        })
        .catch(error => {
            console.error("Error fetching issue types:", error);
        });
});
</script>

</html>
